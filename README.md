# Duality Framework

**The "TSX for C#" WebAssembly Framework.**

Duality is a zero-overhead, reactive framework for building web applications using C# and WebAssembly. It combines the developer experience of JSX (using the `.csx` format) with the performance of .NET 9 and server-side interactivity powered by HTMX.

## üöÄ Quick Start

Build your first Duality app in seconds using the `dlty` CLI.

### 1. Prerequisites
- [.NET 9.0 SDK](https://dotnet.microsoft.com/download/dotnet/9.0)
- `wasm-tools` workload:
  ```bash
  dotnet workload install wasm-tools
  ```

### 2. Create and Run
```bash
# Create a new project
dlty new MyDualityApp

# Start the development server
cd MyDualityApp
dlty dev
```
*Your app will be available at `http://localhost:5000` with hot-reloading enabled.*

---

## ‚ú® Core Features

### üì° Server Actions & Static State
Duality uses a server-driven reactivity model. State is managed via `static` fields, and interactivity is defined through `[Server]` actions that the compiler automatically wires up with HTMX.

```csharp
component Counter {
    static int Count = 0;

    [Server]
    public static void Increment() {
        Count++;
    }

    return (
        <div class="card">
            <p>Count is: {Count}</p>
            <button onclick={Increment}>
                Increment
            </button>
        </div>
    );
}
```

### üé® CSS Modules integration
Components in Duality automatically support scoped CSS via `.css` files matched to your `.csx` files.

```css
/* Counter.css */
.container {
    padding: 1rem;
    border-radius: 8px;
    background: #f4f4f4;
}
```

```csharp
// Counter.csx
component Counter {
    return <div class={Css.Container}>Styled Content</div>;
}
```

### üõ†Ô∏è The `dlty` CLI
Manage your project structure with ease using the built-in generator.

- **Generate Components**: `dlty g component MyHeader` (defaults to `Shared/UI`)
- **Generate Pages**: `dlty g page Home`
- **Scoped Generation**: `dlty g component Profile --layer features` (places in `Features/Profile`)

---

## üèóÔ∏è Project Structure

- **[Duality.Compiler](Duality.Compiler)**: The source generator transforming `.csx` to optimized C# or HTML.
- **[Duality.Core](Duality.Core)**: The runtime engine (Interop, HandlerRegistry).
- **[Duality.CLI](Duality.CLI)**: Developer productivity tool (`dlty`).
- **[CSX.Wasm](CSX.Wasm)**: The WASM host and bootloader.

---

## üî¨ Architecture: Server-Side Reactivity

Duality achieves instant startup and minimal client-side weight by leveraging **Server Actions** and **HTMX**.

### How it Compiles
The compiler transforms your C# methods and JSX event handlers into declarative attributes that describe network interactions.

**Source (`Counter.csx`):**
```csharp
<button onclick={Increment}>Increment</button>
```

**Emitted HTML (Generated):**
```html
<button hx-post="/_rpc/Counter/Increment" hx-target="closest div" hx-swap="outerHTML">
    Increment
</button>
```

When clicked, HTMX sends a POST request to the autogenerated RPC endpoint. The server executes the `static void Increment()` method, re-renders the component with the new `Count` value, and returns the updated HTML fragment for an instant, seamless swap.

---
